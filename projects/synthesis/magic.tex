

%\newcommand*{\ACM}{}%

\ifdefined\ACM

%\documentclass[sigplan,screen]{acmart}
\documentclass[manuscript,screen,review]{acmart}

\else
  \documentclass[14pt]{article}
\usepackage{libertine}
\input{./usepackage}
\usepackage{cancel}
\usepackage{subcaption}
\addbibresource{./sample.bib}

\fi

\begin{document}
\input{newcommands}
\title{ $\sqrt{n} \mapsto \Theta(n)$  Magic States 'Distillation' Using
Quantum LDPC Codes. }
\author{David Ponarovsky}
\maketitle

\newcommand*{\Mbas}{\mathcal{X}^\prime}
\newcommand*{\sMbas}{\text{span }\Mbas}
\newcommand*{\QQ}{C_{X}/C_{Z}^\perp }
\newcommand*{\trig}{Triorthogonal }
\newcommand*{\Hyp}{Hyperproduct }
\newcommand*{\Cin}{ C_{\text{initial}} }
\newcommand*{\Ctan}{ C_{\text{Tanner}} }


\section{Notations, Definitions and Construction.} The notation used in this paper follows standard conventions for coding theory. We use $n$ to represent the length of the code, $k$ for the code's dimension, and $\rho$ for its rate. The minimum distance of the code will be denoted as $d$, and the relative distance, i.e., $d/n$, as $\delta$. In this paper, $n$ and $k$ will sometimes refer to the number of physical and logical bits. Codes will be denoted by a capital $C$ followed by either a subscript or superscript. When referring to multiple codes, we will use the above parameters as functions. For example, $\rho(C_{1})$ represents the rate of the code $C_{1}$. Square brackets are used to present all these parameters compactly, and we use them as follows: $C=[n,k,d]$ to declare a code with the specified length, dimension, and distance. Any theorem, lemma, or claim that states a statement that is true in the asymptotic sense refers to a family of codes. The parity check matrix of the code will be denoted as $H$, with the rows of $H$ representing the parity check equations. The generator matrix of the code will be denoted as $G$, with the rows of $G$ representing the basis of codewords. The syndrome of a received word will be denoted as $s$, which is the result of multiplying $r$ by the transpose of $H$. We use $C^\perp$ to denote the dual code of $C$, which is defined such that any codeword of it $z\in C^\perp$ is orthogonal to any $x\in C$, meaning $z\cdot x = 0$, where the product is defined as $x\cdot z = \sum_{i}{x_{i}z_{i}}$. $C^{\top}$ stands for the code obtained by taking the parity check matrix of $C$ and transposing it.

In this paper, we define the triple product $\mathbb{F}_2^{n}\times \mathbb{F}_2^{n}\times\mathbb{F}_2^{n} \rightarrow \mathbb{Z}$ as $|x\cdot y \cdot z| = \sum_{i}^{n}{x_{i}y_{i}z_{i}}$. Similarly, we define the binary product $|x \cdot y|$, noting that this product differs from the standard product by mapping into $\mathbb{Z}$ rather than $\mathbb{F}_{2}$. For $w \in \mathbb{F}_{2}^{n}$, we use the super operator $ \cdot |_{w} $ to map an operator originally defined in an $n$-dimensional space to an operator that only acts on coordinates restricted to $w$. For example, $x|_{w}$ is the vector in $\mathbb{F}_{2}^{|w|}$ obtained by taking the values of $x$ on coordinates where $w$ is not zero. $|x\cdot y|_{w} = \sum_{i:w_{i}\neq 0}{x_{i}y_{i}}$ and $C|_{w}$ is the code obtained by taking the codewords of $C$ restricted to $w$.

\begin{definition}
  Let $C$, $\tilde{C}$ be linear binary codes at the same length, We will say that $\tilde{C}$ is a \trig with respect to $C$ if: 
  \begin{enumerate}
    \item $\tilde{C} \subset C$
    \item $|x\cdot y \cdot z|$ is even for $x,y,z \in C$ such that at least one of $x,y,z$  belongs to $\tilde{C}$. 
    \item $|x\cdot y|$ is even for $x,y \in C$ such that at least one of $x,y$  belongs to $\tilde{C}$. 
  \end{enumerate}
  For example, the empty code, that contains only the zero code word, is a \trig with respect to any code. In fact for proving \Cref{theorem:main} taking the empty code is sufficient.  
\end{definition}

\begin{definition}
Let $\Delta$ be a constant integer, $C_{0}$ and $\tilde{C}_{0}$ be codes over $\Delta$ bits such that $\tilde{C}_{0}$ is \trig with respect to $C^{\perp}_{0}$. $C_{0}$ has parameters $\Delta[1,\delta_{0},\rho_{0}]$, and $C_{0}^\top$ has relative distance greater than $\delta_{0}$. Let $\Ctan$ be a Tanner code, defined by taking an expander graph with good expansion and $C_{0}$ as the small code. Let $\Cin$ be the dual-tensor code obtained by taking $(\Ctan^\perp \otimes \Ctan^\perp )^\perp$. Note that first, this code has a positive rate and $\Theta(\sqrt{n})$ distance. Second, this code is an LDPC code as well. Also, notice that $\Cin^{\top}$ is obtained by transporting the parity check matrix, and therefore equals to $(\Ctan^{\top, \perp} \otimes \Ctan^{\top, \perp} )^\perp$. Hence, $\Cin^{\top}$ has a square root distance as well.

Let $Q$ be the CSS code obtained by taking the \Hyp of $\Cin$ with itself. So, $Q$ is a quantum qLDPC code with parameters $[n, \Theta(n^{\frac{1}{4}}), \Theta(n)]$. The notations $Q,\Ctan, \Cin, \tilde{C}_{0}, C_{0}$ will keep these definitions for the rest of the paper.
\end{definition}

In this work, we consider quantum circuits under the Clifford-free noise model. In this model, it is assumed that any of the Clifford gates, such as $S$, $H$, and $CZ$, can be applied perfectly. Additionally, the circuits have access to noisy magic states at an error rate of $p$, formulated as the mixed state $(1-p)\ket{T} + pZ\ket{T}$, where $p \in (0,1)$ is the probability that a given state is actually a faulty one and $\ket{T}= \frac{1}{\sqrt{2}}(\ket{0} + e^{i\frac{\pi}{4}}\ket{1})$ is a Magic State. Finally, the model allows for intermediate measurements and the application of Clifford gates controlled by the classical outcomes of the measurements. It has been shown that this model is quantum universal. The Magic State Distillation Protocol is a quantum circuit in the Clifford-free noise model that consumes $n$ noisy magic states at an error rate of $p$ and outputs $k$ independent magic states at an error rate of $\frac{1}{\varepsilon}$. Here, we show the existence and construction of protocols that consume $\sqrt{n}$ Magic States and produce, almost surely, $\Theta(n)$ perfect Magic States. We emphasize that the protocols output dependent states, i.e., if the protocol fails, then any of the $\Theta(n)$ outcomes is a faulty Magic state. This is why we put the phrase "Distillation" in quotation marks in the title.

\begin{theorem}[$\sqrt{n} \rightarrow n$ 'Distillation']
  \label{theorem:main}
There exists is $p_0 \in (0,1)$ such that for the Clifford-free noise model with an error rate $p < p_{0}$, there is a family of circuits that, for sufficiently large $n$, consume $\sqrt{n}$ noisy Magic States and with  probability greater than $1 - e^{-n^{1/8}}$ output $\Theta(n)$ perfect Magic States. Furthermore, both the width and depth of the circuits are linear in $n$.
\end{theorem}
\subsection{The Protocol's Description.} 
Consider $Q$ in the computation base $\QQ$. Let $x_{0}$ be a codeword of $\QQ$. Denote by $w \in \mathbb{F}_{2}^{n}$ the binary string that represents the $Z$-generator that anti-commutes with the $X$-generator corresponding to $x_{0}$. Let $\mathcal{X} = \{x_{0}, x_{1}, .. x_{k^\prime}\} \in \mathbb{F}_{2}^{n}$ be a subset of a basis for the code $\QQ$. Such $\left(\text{span } \mathcal{X}/x_0 \ \right)|_{w}$ is a \trig code with respect to $C_{X}|_{w}$. Let us denote by $\Mbas$ the basis $\{ y_{1}, y_{2}, .., y_{k^\prime} \} \in \mathbb{F}_{2}^{n}$ defined as follows: $ y_{i} = x_{j} + x_{0}$. Denote by $E$ the circuit that encodes the $i$th logical bit to $y_{i}$, by $T^{(w)}$ the application of $T$ gates on the qubits for which $w$ acts non-trivially, meaning $T^{(w)}$ is a tensor product of $T$'s and identity where on the $i$th qubit $T^{(w)}$ applies $T$ if $w_{i}$ equals $1$, and identity otherwise. Finally, let $D$ denote the gate that decodes binary strings in $\mathbb{F}_{2}^{n}$ back into the logical space.

Let $\ket{\Mbas} \propto \sum_{x \in \text{span } \Mbas }{\ket{x}}$.
\section{Proof of Theorem 1.}
\begin{claim}
  There exists family of non-trivial distance quantum LDPC codes $Q$ such the codes $\sMbas$ chosen respect to them has a positive rate. Furthermore, the rate of $\sMbas$ is a asymptotically converges to $Q$ rate:
  \begin{equation*}
    \begin{split}
      \left| \rho\left(Q\right) - \rho\left(\sMbas\right) \right| = o(1)
    \end{split}
  \end{equation*}
\end{claim}
\begin{proof}
   Pick $x_{0}$ and $w \in \mathbb{F}_{2}^{n}$ , which correspond to the supports of anti commute $X$ and $Z$ generators, such that $w$ can be obtains by setting a codeword of $\Ctan$ on the first $n^{\frac{1}{4}}$ bits and padding by zeros the rest. Clearly, $|w| = \Theta(n^{\frac{1}{4}})$.

  Now for defying $\text{span }\mathcal{X}$, we are going to consider the parity checks matrix obtained by adding restrictions to $C_{X}$'s restrictions as follows: Divide the first $w$ bits into $\Delta$-size buckets, define by $w(i)$ the $i$th coordinate on which $w$ isn't trivial. For example if $w(1)=j$ then $j$ is the first nonzero coordinate of $w$, Denote by $B_{1},B_2,.., B_{|w|/\Delta}$ the partion of $w$'s bits: 
  \begin{equation*}
    \begin{split}
      B_{1} &= \left\{w(1), w(2), ..,w(\Delta)\right\}\\
      B_{2} &= \left\{w(\Delta + 1), w(\Delta + 2), ..,w(2\Delta) \right\}\\
      B_{i} &= \left\{w((i-1)\Delta + 1), w((i-1)\Delta + 2), ..,w(i\Delta) \right\}
    \end{split}
  \end{equation*}

  Then let $\text{span }\mathcal{X}$ be all the codewords of $\QQ$ satisfying $\tilde{C}_{0}$ restrictions for each bucket, Let us name the union of $\tilde{C}_{0}$ restrictions over the buckets by $B$. The dimension of the space satisfies both $C_{X}$ restrictions and $B$ is at least:
  \begin{equation*}
    \begin{split}
      \rho(C_{X})\cdot n - |B|\cdot (1 - \rho(\tilde{C}_{0}))\Delta \ge \rho(C_{X})\cdot n - n^{\frac{1}{4}}
    \end{split}
  \end{equation*}
  And by the fact that the dimension of $C_{Z}^\perp$'s codewords satisfying $B$ is strictly lower then $\dim C_{Z}^\perp$, we get the following lower bound:
  \begin{equation*}
    \begin{split}
      \dim \text{span } \mathcal{X} & \ge \rho(C_{X})\cdot n - n^{\frac{1}{4}} + \rho(C_{Z})\cdot n - n \\
     & \ge \rho (Q) - n^{\frac{1}{4}}
    \end{split}
  \end{equation*}
\end{proof}

\begin{remark}
  We emphasise that the above proof can be easily adapted to result the following for general CSS codes: 
\begin{equation*}
    \begin{split}
      \left| \rho\left(Q\right) - \rho\left(\sMbas\right) \right| = d(Q)(1 - \rho(\tilde{C}_{0}))
    \end{split}
  \end{equation*}
  For example lets consider the quantum Tanner code. Since the distance of the quantum Tanner codes is $\sim n/\Delta$, where $\Delta^{2}$ is the degree of the square complex graph, (obtained by taking a codeword for which each local view of it is supported only on rows correspond to a specific single left generator), we get that for any $\rho \in (0,\frac{1}{2})$ one there is a good qLDPC such that the dimension of $\sMbas$ obtained respecting to it $\ge (1-2\rho)^{2}n - n/\Delta \cdot (1 - \rho(\tilde{C}_{0}))$.  
\end{remark}

\begin{claim}
  There is a family of quantum circuits $\mathcal{C}$ consists of Clifford gates and at most $o(\sqrt{n})$ number of $T$ gates such that: 
  \begin{equation*}
    \begin{split}
      T^{(w)}\ket{\Mbas + C_{Z}^{\perp}} \propto E \ \mathcal{C} \ \left(TH\right)^{\rho\left(\sMbas\right)n} \ket{0} 
    \end{split}
  \end{equation*}
\end{claim}
\begin{proof}
  Let $\tau \in \sMbas + C_{Z}^\perp$, applying $T^{(w)}$ on $\ket{\tau}$ add a phase of $i\frac{\pi}{4}\left|\tau\right|_{w}$. Notice that $\tau$ can decompose to the sum of  $x_{0} + y + z$ when $y \in \text{ span } \mathcal{X}$ and $z\in C_{Z}^{\perp}$, so 

  \begin{equation*}
    \begin{split}
  \left|\tau\right|_{w} &= \left| x_{0} + y _ z  \right|_{w} \\
  &= |x_{0}|_{w} + |y|_{w} +|z|_{w} - 2| x \cdot y |_{w} - 2| x \cdot z |_{w} -2| z \cdot y |_{w} + 4|x_{0}\cdot y \cdot z|_{w}  \\
  &= |x_{0} \cdot w| + |y|_{w} +|z|_{w} - 2|y|_{w} - 2|z|_{w} -2| z \cdot y |_{w} + 4|y \cdot z|_{w}  
    \end{split}
  \end{equation*}
  Since we picked $\tilde{C}_{0} \in C_{0}^{\perp}$ then $y \cdot z|_{w} = 0$ $\Rightarrow |y \cdot z|_{w}|$ is even.
\end{proof}


% Notice , So $x_{0}\cdot w = 1$ and for any other
%$x^\prime \in \mathcal{X}/x_{0}$ it holds that $x^{\prime}\cdot w = 0 $.



%\input{./tempmagic.tex}

\printbibliography

\end{document}

