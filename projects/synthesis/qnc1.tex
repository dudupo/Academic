

%\newcommand*{\ACM}{}%

\ifdefined\ACM

%\documentclass[sigplan,screen]{acmart}
\documentclass[manuscript,screen,review]{acmart}

\else
  \documentclass[18pt]{article}
\usepackage{libertine}
\usepackage{cuted}
%\usepackage{widetext}
\input{./usepackage}
\usepackage{cancel}
\usepackage{subcaption}
\addbibresource{./sample.bib}

\fi

\begin{document}
\input{newcommands}
\title{ $\textbf{QNC}_{1} \subset $ noisy-\textbf{BQP}}
\author{Michael Benor \ \ David Ponarovsky}
\maketitle

\newcommand*{\Mbas}{\mathcal{X}^\prime}
\newcommand*{\bas}{\mathcal{X}}
\newcommand*{\sMbas}{\Mbas}
\newcommand*{\QQ}{C_{X}/C_{Z}^\perp }
\newcommand*{\trig}{ Triorthogonal }
\newcommand*{\Hyp}{ Hyperproduct }
\newcommand*{\Cin}{ C_{\text{initial}} }
\newcommand*{\Ctan}{ C_{\text{Tan}} }



%\section{Introduction} blablabla


\section{ Notations. }
$C_{g}$ - good qLDPC, $C_{ft}$ - concatenation code ($ft$ stands for fault tolerance). For a code $C_{y}$ we use $\Phi_{y}, E_{y}, D_{y}$ to denote the channel maps circuits into the circuits compute in the code space, the encoder, and the decoder. We use $\Phi_{U}$ to denote the 'Bell'-state storing the gate $U$. 


\section{ The Noise Model }


\section{ Fault Tolerance (With Resets gates) at Linear Depth. } 

\begin{claim}
  There is $p_{th} \in (0,1)$ such that if $p < p_{th}$ then any quantum circuit $C$ with depth $D$ and width $W$ can be computed by $p$-noisy, resets allowed, circuit $C^{\prime}$, with a depth at most $\max{ \{D, \log(WD) \} }$. 
\end{claim}


\subsection{Initializing Magic for Teleportation gates and encodes ancillaries.}

The Protocol:
\begin{enumerate}
  \item Initializing zeros. Divide the qubits into $|B|$-size blocks. Encodes each block in $C_{g}$ via $D_{ft} \Phi_{ft}[E_{g}] \ket{0^{|B|}}$.
  \item Initializing Magic for Teleportation gates encoded in $C_{g}$ via $D_{ft} \Phi_{ft}[E_{g}] \ket{\Phi_{U}}$ for each gate $U$ in the original circit .
  \item Each gate is replaced by gate teleportation.  
  \item At any time tick, any block runs a single round of error reduction.  
\end{enumerate}


\begin{claim}
  \label{claim:error} 
  Assume that an error $|e| = \gamma n $, i.e $e$ is supported on less than $\gamma n$ bits, then a single correction round reduce $e$ into an error $e^\prime$ such $|e^{\prime}| < \nu |e|$. 
\end{claim}


\begin{definition}
  \label{def:mono} We will say that a CSS code $C$ is monotonic if for for any two codewords $X_{1} , X_{2} \in C_{X}/C_{Z}^{\perp}$ such that $X_{1} = \sum_{i}{g^{(1)}_{i}},X_{2} = \sum_{i}{g^{(2)}_{i}}$ and $\{g^{(1)}\} \cap   \{g^{(1)}\} = \emptyset$ it holds that: 
  \begin{equation*}
    \begin{split}
      | X_{1} + X_{2} | > \frac{3}{2} \left(|X_{1}| + |X_{2}|\right)
    \end{split}
  \end{equation*}
  For example, the Toric code is monotonic. In addition it's straightforwardly to see that concatenation of two monotonies code yield monotonic code.
\end{definition}

\begin{claim}
  The gate $ D_{ft} \Phi_{ft}[E_{g}]$ initializes states encoded in $C_{g}$ subject to $p$-noise channel.  
\end{claim}
\begin{proof}
  Clearly $\Phi_{ft}[E_{g}]$ success, with high probability, let's say $1 - \frac{1}{poly(n)}$, to encode in to $ C_{ft} \circ C_{g}$. Denote by $E_{i}, D_{i}$ the encoder and the decoder at the $i$th level of the concatination construction. Recall that by definition $D_{i}E_{i} = I$, or in other words $D_{i}= E_{i}^{\dagger}$, Hence for any paulis  $P_{1},P_{2},..P_{l}$ such $P_{i}$'s can be corrected by $E_{i},D_{i}$, and any two quantum states we have the following:  
 % \begin{widetext}
  \begin{equation*}
    \begin{split}
      \braket{ \psi^{\prime} | P_{i}E_{i}P_{i-1}E_{i-1},..,P_{1}E_{1} \psi } = \braket{ \psi^{\prime} P_{i}D_{i}P_{i-1}D_{i-1},..,P_{1}D_{1} | \psi }
    \end{split}
  \end{equation*}
  Thus for any pauli-channel $\mathcal{N} : L(H) \rightarrow L(H)$, and $\psi^{\prime}$ which is a codeword we get: 
  \begin{equation*}
    \begin{split}
      \braket{ \psi^{\prime} \mathcal{N}(D) | \psi } &=  \sum_{P_{1}, P_{2}, .., P_{i} \in \mathcal{P}}{ \prb{P_{1}, P_{2}, .., P_{i}}  \braket{ \psi^{\prime} P_{i}D_{i}P_{i-1}D_{i-1},..,P_{1}D_{1} | \psi }} \\
      &=  \sum_{P_{1}, P_{2}, .., P_{i} \in \mathcal{P}^{\star}}{  \prb{P_{1}, P_{2}, .., P_{i}}\braket{ \psi^{\prime} | P_{i}E_{i}P_{i-1}E_{i-1},..,P_{1}E_{1} \psi }} \pm O(  \frac{1}{poly(n)})\\
      &=  \sum_{P_{1}, P_{2}, .., P_{i} \in \mathcal{P}^{\star}}{  \prb{P_{1}, P_{2}, .., P_{i}}\braket{ \psi^{\prime} | P_{i} E \psi }} \pm O(  \frac{1}{poly(n)})\\
      &\le  \sum_{ P_{i} \in \mathcal{P}}{  \prb{ P_{i}}\braket{ \psi^{\prime} | P_{i} E \psi }} \pm O(  \frac{1}{poly(n)}) \\
      &\le  \sum_{ P_{i} \in \mathcal{P}^{\le d}}{  \prb{ P_{i}}\braket{ \psi^{\prime} | P_{i} E \psi }} \pm O (e^{-d \cdot n} ) \pm O(  \frac{1}{poly(n)}) \\
      & \le   \sum_{ P_{i} \in \mathcal{P}/\mathcal{P}^{\star}}{  \prb{ P_{j} \in B_{d}\left( P_{i} \right)}\braket{ \psi^{\prime} | P_{i} E \psi }}  \pm O (e^{-d \cdot n} ) \pm O(  \frac{1}{poly(n)}) 
    \end{split}
  \end{equation*}
  Using the fact that the concatenation code is monotonic (\Cref{def:mono}) we get that the probability to have physical fault $P_{j}$.   
%\end{widetext}
\end{proof}

\begin{claim}
  With probability $ 1 - \frac{WD}{|B|} \cdot D 2e^{-2|B|(\beta - p)} $, the total amount of noise been absorb in a block, in any time $t$, is less than $\gamma n$. 
\end{claim}
\begin{proof}
  Consider the $i$th block,  denoted by $B_{i}$. Using the Hoeffding's inequality we have that the probability that more than $\beta |B|$ bits are flipped at time $t$ is less than $ \le 2e^{-2|B|(\beta - p)} $. Using the union bounds over all the blocks at all the different time location we get that with probability $ 1 - \frac{WD}{|B|} \cdot D 2e^{-2|B|(\beta - p)} $. Denote by $X_{t}$ the support's size of the error over $B_{i}$ at time $t$. Now using \Cref{claim:error}, given that $X_{t-1} \le \gamma n$ it follows that total amount of error absorbed by a block until time $t$ can be bounded by: 
  \begin{equation*}
    \begin{split}
  X_{t} \le \nu \cdot (X_{t-1} + \beta |B| ) \le  \nu(\gamma+\beta) |B| \le \gamma |B|
    \end{split}
  \end{equation*}

%  \begin{equation*}
%    \begin{split}
%      \prb{ \beta n \text{ bits were flipped in } B_{i} \text{ at time } t  } \le 2e^{-2|B|(\beta - p)} 
%    \end{split}
%  \end{equation*}
%  Taking the union bound over the 
\end{proof}






%\input{./tempmagic.tex}
%\cite{leverrier2022quantum}
%\cite{moore1998parallel}
%\cite{Tillich_2014}
%\cite{meier2012magicstate}
%\cite{bravyi2012magic}
\printbibliography

\end{document}

